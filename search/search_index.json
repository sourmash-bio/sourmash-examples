{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"index.html","text":"Welcome to the sourmash examples site! This is a collection of examples and recipes for the sourmash software , for fast genomic and metagenomic sequencing data analysis. sourmash can quickly search genomes and metagenomes for matches; see our list of available search databases . sourmash also supports taxonomic exploration and classification for genomes and metagenomes with the NCBI and GTDB taxonomies. The paper Large-scale sequence comparisons with sourmash (Pierce et al., 2019) gives an overview of what sourmash does and how sourmash works. Do you have questions or comments? File an issue or come chat on gitter ! Start here! Example: install sourmash Example: create a signature by downloading and sketching a genome sequence Example: download and search 66,000 GTDB genomes with a query genome Example: create a metagenome signature from shotgun sequencing reads Example: analyze a metagenome using 66,000 GTDB genomic representatives All examples All categories This site built with ribbity and mkdocs","title":"Home"},{"location":"index.html#welcome-to-the-sourmash-examples-site","text":"This is a collection of examples and recipes for the sourmash software , for fast genomic and metagenomic sequencing data analysis. sourmash can quickly search genomes and metagenomes for matches; see our list of available search databases . sourmash also supports taxonomic exploration and classification for genomes and metagenomes with the NCBI and GTDB taxonomies. The paper Large-scale sequence comparisons with sourmash (Pierce et al., 2019) gives an overview of what sourmash does and how sourmash works. Do you have questions or comments? File an issue or come chat on gitter !","title":"Welcome to the sourmash examples site!"},{"location":"index.html#start-here","text":"Example: install sourmash Example: create a signature by downloading and sketching a genome sequence Example: download and search 66,000 GTDB genomes with a query genome Example: create a metagenome signature from shotgun sequencing reads Example: analyze a metagenome using 66,000 GTDB genomic representatives","title":"Start here!"},{"location":"index.html#all-examples","text":"","title":"All examples"},{"location":"index.html#all-categories","text":"This site built with ribbity and mkdocs","title":"All categories"},{"location":"1-download-sketch-and-search-a-collection-of-fasta-files.html","text":"Example: download, sketch, and search a collection of FASTA files sourmash-bio/sourmash-examples#1 Download 64 genomes from Awad et al., 2017 : curl -L https://osf.io/download/vbhy5 -o podar-ref.tar.gz tar xzf podar-ref.tar.gz Sketch them all in DNA space using default parameters, using GNU parallel per https://github.com/sourmash-bio/sourmash/issues/1796: parallel -j 8 sourmash sketch dna {} -o {}.sig --name-from-first ::: $(ls *.fa) Build a search database from all the signature files for k=31: sourmash sig cat *.sig -k 31 -o podar-ref.zip Search the database with one of the Shewanella genomes: sourmash search 63.fa.sig podar-ref.zip and you should see: similarity match ---------- ----- similarity match ---------- ----- 100.0% NC_011663.1 Shewanella baltica OS223, complete genome 32.1% NC_009665.1 Shewanella baltica OS185, complete genome Categories This example belongs to the following categories: working with FASTA files examples using sourmash v4.x","title":"Example: download, sketch, and search a collection of FASTA files"},{"location":"1-download-sketch-and-search-a-collection-of-fasta-files.html#example-download-sketch-and-search-a-collection-of-fasta-files","text":"sourmash-bio/sourmash-examples#1 Download 64 genomes from Awad et al., 2017 : curl -L https://osf.io/download/vbhy5 -o podar-ref.tar.gz tar xzf podar-ref.tar.gz Sketch them all in DNA space using default parameters, using GNU parallel per https://github.com/sourmash-bio/sourmash/issues/1796: parallel -j 8 sourmash sketch dna {} -o {}.sig --name-from-first ::: $(ls *.fa) Build a search database from all the signature files for k=31: sourmash sig cat *.sig -k 31 -o podar-ref.zip Search the database with one of the Shewanella genomes: sourmash search 63.fa.sig podar-ref.zip and you should see: similarity match ---------- ----- similarity match ---------- ----- 100.0% NC_011663.1 Shewanella baltica OS223, complete genome 32.1% NC_009665.1 Shewanella baltica OS185, complete genome","title":"Example: download, sketch, and search a collection of FASTA files"},{"location":"1-download-sketch-and-search-a-collection-of-fasta-files.html#categories","text":"This example belongs to the following categories: working with FASTA files examples using sourmash v4.x","title":"Categories"},{"location":"11-create-a-signature-by-downloading-and-sketching-a-genome-sequence.html","text":"Example: create a signature by downloading and sketching a genome sequence sourmash-bio/sourmash-examples#11 first, download a genome: curl -JLO https://osf.io/bjh2y/download This will create a 1.4MB file GCF_000005845.2_ASM584v2_genomic.fna.gz containing an E. coli K-12 genome for strain MG1655 (see Genbank entry ). Next, calculate the signature using sourmash sketch dna : sourmash sketch dna -p abund GCF_000005845.2_ASM584v2_genomic.fna.gz here, the -p abund tells sourmash sketch to also retain the abundance (frequency) information for k-mers. This will produce a signature file , GCF_000005845.2_ASM584v2_genomic.fna.gz.sig , that is much smaller than the original genome file (86k vs 1.4 MB). You can view the metadata properties of this signature with sourmash sig describe : sourmash sig describe GCF_000005845.2_ASM584v2_genomic.fna.gz.sig This example was taken from Large scale sequence comparisons with sourmash , Pierce et al., 2019 . Categories This example belongs to the following categories: working with FASTA files introductory examples analyzing genomes","title":"Example: create a signature by downloading and sketching a genome sequence"},{"location":"11-create-a-signature-by-downloading-and-sketching-a-genome-sequence.html#example-create-a-signature-by-downloading-and-sketching-a-genome-sequence","text":"sourmash-bio/sourmash-examples#11 first, download a genome: curl -JLO https://osf.io/bjh2y/download This will create a 1.4MB file GCF_000005845.2_ASM584v2_genomic.fna.gz containing an E. coli K-12 genome for strain MG1655 (see Genbank entry ). Next, calculate the signature using sourmash sketch dna : sourmash sketch dna -p abund GCF_000005845.2_ASM584v2_genomic.fna.gz here, the -p abund tells sourmash sketch to also retain the abundance (frequency) information for k-mers. This will produce a signature file , GCF_000005845.2_ASM584v2_genomic.fna.gz.sig , that is much smaller than the original genome file (86k vs 1.4 MB). You can view the metadata properties of this signature with sourmash sig describe : sourmash sig describe GCF_000005845.2_ASM584v2_genomic.fna.gz.sig This example was taken from Large scale sequence comparisons with sourmash , Pierce et al., 2019 .","title":"Example: create a signature by downloading and sketching a genome sequence"},{"location":"11-create-a-signature-by-downloading-and-sketching-a-genome-sequence.html#categories","text":"This example belongs to the following categories: working with FASTA files introductory examples analyzing genomes","title":"Categories"},{"location":"12-create-a-metagenome-signature-from-shotgun-sequencing-reads.html","text":"Example: create a metagenome signature from shotgun sequencing reads sourmash-bio/sourmash-examples#12 First, download two metagenome files: curl -JLO ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR595/007/SRR5950647/SRR5950647_1.fastq.gz curl -JLO ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR595/007/SRR5950647/SRR5950647_2.fastq.gz This will create two 9.2MB files, SRR5950647_1.fastq.gz and SRR5950647_1.fastq.gz , containing shotgun metagenome reads from a stool sample ( see ENA record ). Next, sketch the two metagenome files into a single signature: sourmash sketch dna -p abund SRR5950647_?.fastq.gz -o SRR5950647.sig --name SRR5950647 This will produce a 150kb output file, SRR5950647.sig , containing a k-mer sketch built from both files. You can see the details of the sketch with sourmash sig describe : sourmash sig describe SRR5950647.sig Categories This example belongs to the following categories: introductory examples working with FASTQ files analyzing metagenomes","title":"Example: create a metagenome signature from shotgun sequencing reads"},{"location":"12-create-a-metagenome-signature-from-shotgun-sequencing-reads.html#example-create-a-metagenome-signature-from-shotgun-sequencing-reads","text":"sourmash-bio/sourmash-examples#12 First, download two metagenome files: curl -JLO ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR595/007/SRR5950647/SRR5950647_1.fastq.gz curl -JLO ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR595/007/SRR5950647/SRR5950647_2.fastq.gz This will create two 9.2MB files, SRR5950647_1.fastq.gz and SRR5950647_1.fastq.gz , containing shotgun metagenome reads from a stool sample ( see ENA record ). Next, sketch the two metagenome files into a single signature: sourmash sketch dna -p abund SRR5950647_?.fastq.gz -o SRR5950647.sig --name SRR5950647 This will produce a 150kb output file, SRR5950647.sig , containing a k-mer sketch built from both files. You can see the details of the sketch with sourmash sig describe : sourmash sig describe SRR5950647.sig","title":"Example: create a metagenome signature from shotgun sequencing reads"},{"location":"12-create-a-metagenome-signature-from-shotgun-sequencing-reads.html#categories","text":"This example belongs to the following categories: introductory examples working with FASTQ files analyzing metagenomes","title":"Categories"},{"location":"13-download-and-search-66000-gtdb-genomes-with-a-query-genome.html","text":"Example: download and search 66,000 GTDB genomes with a query genome sourmash-bio/sourmash-examples#13 You'll need to build the genome signature file in Example: create a signature by downloading and sketching a genome sequence first. Then, download the GTDB genomic representatives database: curl -JLO [https://osf.io/3a6gn/download](https://osf.io/3a6gn/download) This will create a 1.7 GB file, gtdb-rs207.genomic-reps.dna.k31.zip , which contains 66,000 genome sketches from the Genome Taxonomy Database, release 207 . Now search the genome against the GTDB database: sourmash search GCF_000005845.2_ASM584v2_genomic.fna.gz.sig gtdb-rs207.genomic-reps.dna.k31.zip This will take about 5 minutes. The output will look like this: 8 matches; showing first 3: similarity match ---------- ----- 29.9% GCF_003697165.2 Escherichia coli DSM 30083 = JCM 1649 = A... 14.6% GCF_002965065.1 Escherichia sp. MOD1-EC7003 strain=MOD1-E... 14.2% GCF_000026225.1 Escherichia fergusonii ATCC 35469 strain=... showing that this genome is, indeed, an E. coli genome :). The similarity in the left column is Jaccard similarity , calculated using the k-mers in the query genome sketch against the k-mers in each of the database genome sketches. You can increase the number of output results with -n : 8 matches: similarity match ---------- ----- 29.9% GCF_003697165.2 Escherichia coli DSM 30083 = JCM 1649 = A... 14.6% GCF_002965065.1 Escherichia sp. MOD1-EC7003 strain=MOD1-E... 14.2% GCF_000026225.1 Escherichia fergusonii ATCC 35469 strain=... 14.1% GCF_902498915.1 Escherichia ruysiae, OPT1704 14.1% GCF_004211955.1 Escherichia sp. E1V33 strain=E1V33, ASM42... 13.5% GCF_005843885.1 Escherichia sp. E4742 strain=E4742, ASM58... 10.3% GCF_001660175.1 Escherichia sp. B1147 strain=B1147, ASM16... 10.1% GCF_011881725.1 Escherichia coli strain=SCPM-O-B-8794, AS... and you can record the results in a CSV file with -o <output.csv> . Categories This example belongs to the following categories: working with FASTA files examples using GTDB RS207 introductory examples analyzing genomes","title":"Example: download and search 66,000 GTDB genomes with a query genome"},{"location":"13-download-and-search-66000-gtdb-genomes-with-a-query-genome.html#example-download-and-search-66000-gtdb-genomes-with-a-query-genome","text":"sourmash-bio/sourmash-examples#13 You'll need to build the genome signature file in Example: create a signature by downloading and sketching a genome sequence first. Then, download the GTDB genomic representatives database: curl -JLO [https://osf.io/3a6gn/download](https://osf.io/3a6gn/download) This will create a 1.7 GB file, gtdb-rs207.genomic-reps.dna.k31.zip , which contains 66,000 genome sketches from the Genome Taxonomy Database, release 207 . Now search the genome against the GTDB database: sourmash search GCF_000005845.2_ASM584v2_genomic.fna.gz.sig gtdb-rs207.genomic-reps.dna.k31.zip This will take about 5 minutes. The output will look like this: 8 matches; showing first 3: similarity match ---------- ----- 29.9% GCF_003697165.2 Escherichia coli DSM 30083 = JCM 1649 = A... 14.6% GCF_002965065.1 Escherichia sp. MOD1-EC7003 strain=MOD1-E... 14.2% GCF_000026225.1 Escherichia fergusonii ATCC 35469 strain=... showing that this genome is, indeed, an E. coli genome :). The similarity in the left column is Jaccard similarity , calculated using the k-mers in the query genome sketch against the k-mers in each of the database genome sketches. You can increase the number of output results with -n : 8 matches: similarity match ---------- ----- 29.9% GCF_003697165.2 Escherichia coli DSM 30083 = JCM 1649 = A... 14.6% GCF_002965065.1 Escherichia sp. MOD1-EC7003 strain=MOD1-E... 14.2% GCF_000026225.1 Escherichia fergusonii ATCC 35469 strain=... 14.1% GCF_902498915.1 Escherichia ruysiae, OPT1704 14.1% GCF_004211955.1 Escherichia sp. E1V33 strain=E1V33, ASM42... 13.5% GCF_005843885.1 Escherichia sp. E4742 strain=E4742, ASM58... 10.3% GCF_001660175.1 Escherichia sp. B1147 strain=B1147, ASM16... 10.1% GCF_011881725.1 Escherichia coli strain=SCPM-O-B-8794, AS... and you can record the results in a CSV file with -o <output.csv> .","title":"Example: download and search 66,000 GTDB genomes with a query genome"},{"location":"13-download-and-search-66000-gtdb-genomes-with-a-query-genome.html#categories","text":"This example belongs to the following categories: working with FASTA files examples using GTDB RS207 introductory examples analyzing genomes","title":"Categories"},{"location":"14-analyze-a-metagenome-using-66000-gtdb-genomic-representatives.html","text":"Example: analyze a metagenome using 66,000 GTDB genomic representatives sourmash-bio/sourmash-examples#14 This example uses the metagenome signature prepared in Example: create a metagenome signature from shotgun sequencing reads . You'll also need to download the GTDB database as in Example: download and search 66,000 GTDB genomes with a query genome . Now, run sourmash gather : sourmash gather SRR5950647.sig gtdb-rs207.genomic-reps.dna.k31.zip This should take about 5 minutes. The output should look like this: overlap p_query p_match avg_abund --------- ------- ------- --------- 383.0 kbp 2.0% 7.8% 1.6 GCF_003697165.2 Escherichia coli DSM ... 187.0 kbp 1.0% 5.0% 1.6 GCF_015074785.1 Prevotella copri stra... 142.0 kbp 0.7% 2.8% 1.4 GCF_000012825.1 Bacteroides vulgatus ... 164.0 kbp 0.3% 1.4% 1.7 GCF_019127135.1 Prevotella copri stra... found less than 50.0 kbp in common. => exiting found 4 matches total; the recovered matches hit 4.0% of the abundance-weighted query This a minimum metagenome cover for the metagenome, based on the genomes in the GTDB database: in brief, it provides a shortest list of genomes that contain all of the known content in the metagenome (in this case, about 4%). Note: more of the metagenome might be matched if you used a larger database or a database that included eukaryotic and/or host sequence. Categories This example belongs to the following categories: examples using GTDB RS207 introductory examples working with FASTQ files analyzing metagenomes","title":"Example: analyze a metagenome using 66,000 GTDB genomic representatives"},{"location":"14-analyze-a-metagenome-using-66000-gtdb-genomic-representatives.html#example-analyze-a-metagenome-using-66000-gtdb-genomic-representatives","text":"sourmash-bio/sourmash-examples#14 This example uses the metagenome signature prepared in Example: create a metagenome signature from shotgun sequencing reads . You'll also need to download the GTDB database as in Example: download and search 66,000 GTDB genomes with a query genome . Now, run sourmash gather : sourmash gather SRR5950647.sig gtdb-rs207.genomic-reps.dna.k31.zip This should take about 5 minutes. The output should look like this: overlap p_query p_match avg_abund --------- ------- ------- --------- 383.0 kbp 2.0% 7.8% 1.6 GCF_003697165.2 Escherichia coli DSM ... 187.0 kbp 1.0% 5.0% 1.6 GCF_015074785.1 Prevotella copri stra... 142.0 kbp 0.7% 2.8% 1.4 GCF_000012825.1 Bacteroides vulgatus ... 164.0 kbp 0.3% 1.4% 1.7 GCF_019127135.1 Prevotella copri stra... found less than 50.0 kbp in common. => exiting found 4 matches total; the recovered matches hit 4.0% of the abundance-weighted query This a minimum metagenome cover for the metagenome, based on the genomes in the GTDB database: in brief, it provides a shortest list of genomes that contain all of the known content in the metagenome (in this case, about 4%). Note: more of the metagenome might be matched if you used a larger database or a database that included eukaryotic and/or host sequence.","title":"Example: analyze a metagenome using 66,000 GTDB genomic representatives"},{"location":"14-analyze-a-metagenome-using-66000-gtdb-genomic-representatives.html#categories","text":"This example belongs to the following categories: examples using GTDB RS207 introductory examples working with FASTQ files analyzing metagenomes","title":"Categories"},{"location":"15-estimate-how-much-of-a-metagenome-sample-can-be-mapped-to-reference-genomes.html","text":"Example: estimate how much of a metagenome sample can be mapped to reference genomes sourmash-bio/sourmash-examples#15 One question we frequently have about a metagenome is how much of it is known , and one way this can be answered is by asking how many of my metagenome reads can be mapped to a set of reference genome(s)? This can be estimated with sourmash fairly quickly, using any collection of reference genomes you have available! In Example: analyze a metagenome using 66,000 GTDB genomic representatives , we showed how to analyze a metagenome's contents using sourmash gather against the GTDB genomic representatives database. The output was: overlap p_query p_match avg_abund --------- ------- ------- --------- 383.0 kbp 2.0% 7.8% 1.6 GCF_003697165.2 Escherichia coli DSM ... 187.0 kbp 1.0% 5.0% 1.6 GCF_015074785.1 Prevotella copri stra... 142.0 kbp 0.7% 2.8% 1.4 GCF_000012825.1 Bacteroides vulgatus ... 164.0 kbp 0.3% 1.4% 1.7 GCF_019127135.1 Prevotella copri stra... found less than 50.0 kbp in common. => exiting found 4 matches total; the recovered matches hit 4.0% of the abundance-weighted query and it turns out that these numbers provide accurate estimates for mapping rates. Specifically: the p_query column tells you what fraction of the metagenome reads will map to each genome. So here about 2% of the reads will map to GCF_003697165.2 , an E. coli genome, and about 1% of the reads will map to GCF_015074785.1 , a Prevotella genome. The p_match column tells you what fraction of the bases in the genome will be covered by the mapped reads . So for the GCF_003697165.2 E. coli genome, about 7.8% of the genome will be covered by reads from this metagenome. Finally, the statement \"the recovered matches hit 4.0% of the abundance-weighted query\" tells you that overall, 4% of the reads in the metagenome will map to your database.** All of these numbers (and many more) are also available in the CSV output. See this section of the sourmash docs for some details on how sourmash gather works, what is output to a CSV file, and how the CSV output Caveats and details A few terms and conditions apply - you need to use abundance-weighted signatures, as calculated here: Example: create a metagenome signature from shotgun sequencing reads the fraction of the genome that can be classified against a database very much depends on that database! So you want to use the most inclusive database that meets your needs. This can include both prepared databases like Genbank, and private databases (see Example: download, sketch, and search a collection of FASTA files ). Publications and software If you're curious about the scientific details and want to see this applied to some larger metagenomes, please see Lightweight compositional analysis of metagenomes with FracMinHash and minimum metagenome covers, Irber et al., 2022 . Last but not least, the genome-grist software software provides a workflow that will map Illumina metagenome reads to a collection of reference genomes. Version notes The summary output statement ( the recovered matches hit 4.0% of the abundance-weighted query ) was introduced in sourmash v4.2.4, with PR sourmash-bio/sourmash#1819 . Prior to that, sourmash didn't distinguish between abundance-weighted and flat output in its text output (although the numbers were weighted properly - it just didn't tell you!) In the future we plan to output both flat and abundance-weighted numbers; see sourmash-bio/sourmash#1818 . Categories This example belongs to the following categories: examples using sourmash v4.2 functionality examples using GTDB RS207 intermediate examples analyzing metagenomes examples that refer to read mapping","title":"Example: estimate how much of a metagenome sample can be mapped to reference genomes"},{"location":"15-estimate-how-much-of-a-metagenome-sample-can-be-mapped-to-reference-genomes.html#example-estimate-how-much-of-a-metagenome-sample-can-be-mapped-to-reference-genomes","text":"sourmash-bio/sourmash-examples#15 One question we frequently have about a metagenome is how much of it is known , and one way this can be answered is by asking how many of my metagenome reads can be mapped to a set of reference genome(s)? This can be estimated with sourmash fairly quickly, using any collection of reference genomes you have available! In Example: analyze a metagenome using 66,000 GTDB genomic representatives , we showed how to analyze a metagenome's contents using sourmash gather against the GTDB genomic representatives database. The output was: overlap p_query p_match avg_abund --------- ------- ------- --------- 383.0 kbp 2.0% 7.8% 1.6 GCF_003697165.2 Escherichia coli DSM ... 187.0 kbp 1.0% 5.0% 1.6 GCF_015074785.1 Prevotella copri stra... 142.0 kbp 0.7% 2.8% 1.4 GCF_000012825.1 Bacteroides vulgatus ... 164.0 kbp 0.3% 1.4% 1.7 GCF_019127135.1 Prevotella copri stra... found less than 50.0 kbp in common. => exiting found 4 matches total; the recovered matches hit 4.0% of the abundance-weighted query and it turns out that these numbers provide accurate estimates for mapping rates. Specifically: the p_query column tells you what fraction of the metagenome reads will map to each genome. So here about 2% of the reads will map to GCF_003697165.2 , an E. coli genome, and about 1% of the reads will map to GCF_015074785.1 , a Prevotella genome. The p_match column tells you what fraction of the bases in the genome will be covered by the mapped reads . So for the GCF_003697165.2 E. coli genome, about 7.8% of the genome will be covered by reads from this metagenome. Finally, the statement \"the recovered matches hit 4.0% of the abundance-weighted query\" tells you that overall, 4% of the reads in the metagenome will map to your database.** All of these numbers (and many more) are also available in the CSV output. See this section of the sourmash docs for some details on how sourmash gather works, what is output to a CSV file, and how the CSV output","title":"Example: estimate how much of a metagenome sample can be mapped to reference genomes"},{"location":"15-estimate-how-much-of-a-metagenome-sample-can-be-mapped-to-reference-genomes.html#caveats-and-details","text":"A few terms and conditions apply - you need to use abundance-weighted signatures, as calculated here: Example: create a metagenome signature from shotgun sequencing reads the fraction of the genome that can be classified against a database very much depends on that database! So you want to use the most inclusive database that meets your needs. This can include both prepared databases like Genbank, and private databases (see Example: download, sketch, and search a collection of FASTA files ).","title":"Caveats and details"},{"location":"15-estimate-how-much-of-a-metagenome-sample-can-be-mapped-to-reference-genomes.html#publications-and-software","text":"If you're curious about the scientific details and want to see this applied to some larger metagenomes, please see Lightweight compositional analysis of metagenomes with FracMinHash and minimum metagenome covers, Irber et al., 2022 . Last but not least, the genome-grist software software provides a workflow that will map Illumina metagenome reads to a collection of reference genomes.","title":"Publications and software"},{"location":"15-estimate-how-much-of-a-metagenome-sample-can-be-mapped-to-reference-genomes.html#version-notes","text":"The summary output statement ( the recovered matches hit 4.0% of the abundance-weighted query ) was introduced in sourmash v4.2.4, with PR sourmash-bio/sourmash#1819 . Prior to that, sourmash didn't distinguish between abundance-weighted and flat output in its text output (although the numbers were weighted properly - it just didn't tell you!) In the future we plan to output both flat and abundance-weighted numbers; see sourmash-bio/sourmash#1818 .","title":"Version notes"},{"location":"15-estimate-how-much-of-a-metagenome-sample-can-be-mapped-to-reference-genomes.html#categories","text":"This example belongs to the following categories: examples using sourmash v4.2 functionality examples using GTDB RS207 intermediate examples analyzing metagenomes examples that refer to read mapping","title":"Categories"},{"location":"16-compare-and-visualize-the-similarity-of-many-genomes-using-average-nucleotide-identity-ani.html","text":"Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI) sourmash-bio/sourmash-examples#16 with sourmash v4.4, sourmash can now estimate Average Nucleotide Identity between genomes: this is the fraction of bases that would be identical in a pairwise alignment. However, sourmash estimates this based on k-mers, instead of using alignments. This is fast and lightweight, and doesn't need access to the full genomes! Let's use ANI with sourmash compare and sourmash plot to look at the relationship between 12 E. coli genomes. First, you'll need to download the GTDB genomic-reps database, containing 66k genomes, as in Example: download and search 66,000 GTDB genomes with a query genome . Then, run compare , selecting just the Escherichia genomes: sourmash compare --include Escherichia gtdb-rs207.genomic-reps.dna.k31.zip --ani -o ecoli-ani.cmp This creates a numpy comparison matrix in ecoli-ani.cmp (you can also generate a CSV output with --csv ). Now, use plot to quickly visualize the comparison matrix: sourmash plot ecoli-ani.cmp This will produce an image ecoli-ani.cmp/matrix.png : This plot shows the clade structure of the 12 E. coli genomes, including three that have no detectable ANI similarity to any other ANI genomes. The genome names corresponding to the label numbers can be found in the ecoli-ani.cmp.labels.txt file. Caveats and details ANI can be estimated by sourmash from ~85% to 99%, depending on the k-mer size used. See https://github.com/sourmash-bio/sourmash/issues/1859 for some numbers for k=21 and k=31. ANI estimates are somewhat dependent on the software and parameters used to calculate them. We are working on a systematic comparison of sourmash's ANI estimates with other ANI software! sourmash ANI estimates are only available for scaled signatures (the default, when signatures are generated with sourmash sketch ). In order to accurately estimate ANI, sourmash signatures need to have enough hashes for the calculation; this is dependent on both the size of the genome(s) and the scaled factor used to generate the signatures. sourmash will output warnings to stderr when the sketches are too small to accurately estimate ANI. Some details on how sourmash estimates ANI are in the sourmash docs . Citations The analytical work underlying the ANI calculations is introduced in Debiasing FracMinHash and deriving confidence intervals for mutation rates across a wide range of evolutionary distances, Hera et al., 2022 . Categories This example belongs to the following categories: examples using sourmash v4.4 functionality using Average Nucleotide Identity (ANI) plots and other output visualizations","title":"Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI)"},{"location":"16-compare-and-visualize-the-similarity-of-many-genomes-using-average-nucleotide-identity-ani.html#example-compare-and-visualize-the-similarity-of-many-genomes-using-average-nucleotide-identity-ani","text":"sourmash-bio/sourmash-examples#16 with sourmash v4.4, sourmash can now estimate Average Nucleotide Identity between genomes: this is the fraction of bases that would be identical in a pairwise alignment. However, sourmash estimates this based on k-mers, instead of using alignments. This is fast and lightweight, and doesn't need access to the full genomes! Let's use ANI with sourmash compare and sourmash plot to look at the relationship between 12 E. coli genomes. First, you'll need to download the GTDB genomic-reps database, containing 66k genomes, as in Example: download and search 66,000 GTDB genomes with a query genome . Then, run compare , selecting just the Escherichia genomes: sourmash compare --include Escherichia gtdb-rs207.genomic-reps.dna.k31.zip --ani -o ecoli-ani.cmp This creates a numpy comparison matrix in ecoli-ani.cmp (you can also generate a CSV output with --csv ). Now, use plot to quickly visualize the comparison matrix: sourmash plot ecoli-ani.cmp This will produce an image ecoli-ani.cmp/matrix.png : This plot shows the clade structure of the 12 E. coli genomes, including three that have no detectable ANI similarity to any other ANI genomes. The genome names corresponding to the label numbers can be found in the ecoli-ani.cmp.labels.txt file.","title":"Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI)"},{"location":"16-compare-and-visualize-the-similarity-of-many-genomes-using-average-nucleotide-identity-ani.html#caveats-and-details","text":"ANI can be estimated by sourmash from ~85% to 99%, depending on the k-mer size used. See https://github.com/sourmash-bio/sourmash/issues/1859 for some numbers for k=21 and k=31. ANI estimates are somewhat dependent on the software and parameters used to calculate them. We are working on a systematic comparison of sourmash's ANI estimates with other ANI software! sourmash ANI estimates are only available for scaled signatures (the default, when signatures are generated with sourmash sketch ). In order to accurately estimate ANI, sourmash signatures need to have enough hashes for the calculation; this is dependent on both the size of the genome(s) and the scaled factor used to generate the signatures. sourmash will output warnings to stderr when the sketches are too small to accurately estimate ANI. Some details on how sourmash estimates ANI are in the sourmash docs .","title":"Caveats and details"},{"location":"16-compare-and-visualize-the-similarity-of-many-genomes-using-average-nucleotide-identity-ani.html#citations","text":"The analytical work underlying the ANI calculations is introduced in Debiasing FracMinHash and deriving confidence intervals for mutation rates across a wide range of evolutionary distances, Hera et al., 2022 .","title":"Citations"},{"location":"16-compare-and-visualize-the-similarity-of-many-genomes-using-average-nucleotide-identity-ani.html#categories","text":"This example belongs to the following categories: examples using sourmash v4.4 functionality using Average Nucleotide Identity (ANI) plots and other output visualizations","title":"Categories"},{"location":"18-ask-for-an-example-of-how-to-use-sourmash-to-do-something.html","text":"Example: ask for an example of how to use sourmash to do something sourmash-bio/sourmash-examples#18 Is there something you would like to do with sourmash? If so, post your request or question on the sourmash issue tracker , and we'll see what we can do! Categories This example belongs to the following categories: introductory examples","title":"Example: ask for an example of how to use sourmash to do something"},{"location":"18-ask-for-an-example-of-how-to-use-sourmash-to-do-something.html#example-ask-for-an-example-of-how-to-use-sourmash-to-do-something","text":"sourmash-bio/sourmash-examples#18 Is there something you would like to do with sourmash? If so, post your request or question on the sourmash issue tracker , and we'll see what we can do!","title":"Example: ask for an example of how to use sourmash to do something"},{"location":"18-ask-for-an-example-of-how-to-use-sourmash-to-do-something.html#categories","text":"This example belongs to the following categories: introductory examples","title":"Categories"},{"location":"2-create-and-use-an-lca-database-for-taxonomic-analysis.html","text":"Example: create and use an LCA database for taxonomic analysis sourmash-bio/sourmash-examples#2 First, download and sketch 64 genomes from Awad et al., 2017 using the instructions in Example: download, sketch, and search a collection of FASTA files . You'll need podar-ref.zip . Next, you'll need podar-lineage.csv - curl -L [https://osf.io/4yhjw/download](https://osf.io/4yhjw/download) -o podar-lineage.csv Now create an LCA database in SQL format: sourmash lca index podar-lineage.csv podar-ref.lca.sql podar-ref.zip \\ -F sql -C 3 --split-identifiers Extract one of the Shewanella genomes from podar-ref.zip using sourmash sig grep : sourmash sig grep OS223 podar-ref.zip -o shew-os223.sig and now you can classify genomes with lca classify : sourmash lca classify --query shew-os223.sig --db podar-ref.lca.sql and you should see it classified correctly: \"NC_011663.1 Shewanella baltica OS223, complete genome\",found,Bacteria,Proteobacteria,Gammaproteobacteria,Alteromonadales,Shewanellaceae,Shewanella,Shewanella baltica,Shewanella baltica OS223 You can use lca summarize to classify the genome as if it were a metagenome mixture, too: sourmash lca summarize --query shew-os223.sig --db podar-ref.lca.sql and you should see: 50.5% 278 Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella;Shewanella baltica;Shewanella baltica OS223 shew-os223.sig:38729c63 NC_011663.1 Shewanella baltica OS223, complete genome 100.0% 550 Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella;Shewanella baltica shew-os223.sig:38729c63 NC_011663.1 Shewanella baltica OS223, complete genome which indicates that about 50% of the content is not strain specific, and is shared with the other Shewanella in the collection. Categories This example belongs to the following categories: examples of using taxonomy examples using sourmash v4.4 functionality","title":"Example: create and use an LCA database for taxonomic analysis"},{"location":"2-create-and-use-an-lca-database-for-taxonomic-analysis.html#example-create-and-use-an-lca-database-for-taxonomic-analysis","text":"sourmash-bio/sourmash-examples#2 First, download and sketch 64 genomes from Awad et al., 2017 using the instructions in Example: download, sketch, and search a collection of FASTA files . You'll need podar-ref.zip . Next, you'll need podar-lineage.csv - curl -L [https://osf.io/4yhjw/download](https://osf.io/4yhjw/download) -o podar-lineage.csv Now create an LCA database in SQL format: sourmash lca index podar-lineage.csv podar-ref.lca.sql podar-ref.zip \\ -F sql -C 3 --split-identifiers Extract one of the Shewanella genomes from podar-ref.zip using sourmash sig grep : sourmash sig grep OS223 podar-ref.zip -o shew-os223.sig and now you can classify genomes with lca classify : sourmash lca classify --query shew-os223.sig --db podar-ref.lca.sql and you should see it classified correctly: \"NC_011663.1 Shewanella baltica OS223, complete genome\",found,Bacteria,Proteobacteria,Gammaproteobacteria,Alteromonadales,Shewanellaceae,Shewanella,Shewanella baltica,Shewanella baltica OS223 You can use lca summarize to classify the genome as if it were a metagenome mixture, too: sourmash lca summarize --query shew-os223.sig --db podar-ref.lca.sql and you should see: 50.5% 278 Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella;Shewanella baltica;Shewanella baltica OS223 shew-os223.sig:38729c63 NC_011663.1 Shewanella baltica OS223, complete genome 100.0% 550 Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella;Shewanella baltica shew-os223.sig:38729c63 NC_011663.1 Shewanella baltica OS223, complete genome which indicates that about 50% of the content is not strain specific, and is shared with the other Shewanella in the collection.","title":"Example: create and use an LCA database for taxonomic analysis"},{"location":"2-create-and-use-an-lca-database-for-taxonomic-analysis.html#categories","text":"This example belongs to the following categories: examples of using taxonomy examples using sourmash v4.4 functionality","title":"Categories"},{"location":"22-detect-potential-contaminants-in-unassembled-and-uncorrected-pacbio-sequencing-data.html","text":"Example: detect potential contaminants in unassembled and uncorrected PacBio sequencing data sourmash-bio/sourmash-examples#22 A colleague was having some trouble mapping all their PacBio reads to the intended genome, so I decided to search it against the prepared Genbank databases with a k-mer size of 21: # construct a signature sourmash sketch dna -p k=21 reads.fastq -o reads.sig # search against genbank using 'prefetch' with a low threshold to identify small overlaps sourmash prefetch reads.sig genbank*-k21.zip -o reads.prefetch.csv --threshold-bp=0 I then analyzed the output CSV like so: csvtk cut -f intersect_bp,match_name reads.prefetch.csv | sort -n | tail to get the 10 largest matches (this uses csvtk ). The output was the following: 19000,\"GCA_002018415.1 Enterobacter kobei strain=ICBECLAM6, ASM201841v1\" 19000,\"GCA_003383805.1 Staphylococcus pseudintermedius strain=ST68, ASM338380v1\" 19000,\"GCA_019057835.1 Candidatus Lokiarchaeota archaeon, ASM1905783v1\" 19000,\"GCA_020721325.1 Paludibacter propionicigenes, ASM2072132v1\" 21000,\"GCA_019389785.1 Streptomyces griseus subsp. griseus strain=51d, ASM1938978v1\" 22000,\"GCA_005787405.1 Rickettsiales bacterium, ASM578740v1\" 23000,\"GCA_001653815.2 Opitutaceae bacterium TAV3 strain=TAV3, ASM165381v2\" 32000,\"GCA_018274365.1 Escherichia coli strain=MTR_BAU01, ASM1827436v1\" 36000,\"GCA_913774445.1 uncultured Acinetobacter sp., maxbin_SP184_1.002_sub\" 39000,\"GCA_913774065.1 uncultured Acinetobacter sp., maxbin_SP424_1.012_sub_cleaned\" suggesting that there are substantial potential overlaps (~39kb and longer) with an Acinetobacter genome. Categories This example belongs to the following categories: intermediate examples","title":"Example: detect potential contaminants in unassembled and uncorrected PacBio sequencing data"},{"location":"22-detect-potential-contaminants-in-unassembled-and-uncorrected-pacbio-sequencing-data.html#example-detect-potential-contaminants-in-unassembled-and-uncorrected-pacbio-sequencing-data","text":"sourmash-bio/sourmash-examples#22 A colleague was having some trouble mapping all their PacBio reads to the intended genome, so I decided to search it against the prepared Genbank databases with a k-mer size of 21: # construct a signature sourmash sketch dna -p k=21 reads.fastq -o reads.sig # search against genbank using 'prefetch' with a low threshold to identify small overlaps sourmash prefetch reads.sig genbank*-k21.zip -o reads.prefetch.csv --threshold-bp=0 I then analyzed the output CSV like so: csvtk cut -f intersect_bp,match_name reads.prefetch.csv | sort -n | tail to get the 10 largest matches (this uses csvtk ). The output was the following: 19000,\"GCA_002018415.1 Enterobacter kobei strain=ICBECLAM6, ASM201841v1\" 19000,\"GCA_003383805.1 Staphylococcus pseudintermedius strain=ST68, ASM338380v1\" 19000,\"GCA_019057835.1 Candidatus Lokiarchaeota archaeon, ASM1905783v1\" 19000,\"GCA_020721325.1 Paludibacter propionicigenes, ASM2072132v1\" 21000,\"GCA_019389785.1 Streptomyces griseus subsp. griseus strain=51d, ASM1938978v1\" 22000,\"GCA_005787405.1 Rickettsiales bacterium, ASM578740v1\" 23000,\"GCA_001653815.2 Opitutaceae bacterium TAV3 strain=TAV3, ASM165381v2\" 32000,\"GCA_018274365.1 Escherichia coli strain=MTR_BAU01, ASM1827436v1\" 36000,\"GCA_913774445.1 uncultured Acinetobacter sp., maxbin_SP184_1.002_sub\" 39000,\"GCA_913774065.1 uncultured Acinetobacter sp., maxbin_SP424_1.012_sub_cleaned\" suggesting that there are substantial potential overlaps (~39kb and longer) with an Acinetobacter genome.","title":"Example: detect potential contaminants in unassembled and uncorrected PacBio sequencing data"},{"location":"22-detect-potential-contaminants-in-unassembled-and-uncorrected-pacbio-sequencing-data.html#categories","text":"This example belongs to the following categories: intermediate examples","title":"Categories"},{"location":"3-use-sourmash-tax-to-classify-a-metagenome.html","text":"Example: use sourmash tax to classify a metagenome sourmash-bio/sourmash-examples#3 First, download and sketch 64 genomes from Awad et al., 2017 using the instructions in Example: download, sketch, and search a collection of FASTA files . You'll need podar-ref.zip . Next, you'll need podar-lineage.csv - curl -L [https://osf.io/4yhjw/download](https://osf.io/4yhjw/download) -o podar-lineage.csv Next we'll make a fake metagenome consisting of a signature created by merging two Shewanella baltica signatures. First, extract signatures with Shewanella in the name from podar-ref.zip : sourmash sig grep Shewanella podar-ref.zip -o shew-matches.sig Then, use sourmash sig merge to merge them into one signature: sourmash sig merge shew-matches.sig -o shew-merge.sig This is our fake metagenome that we'll use to demonstrate sourmash tax . Now that we've got our fake metagenome, run sourmash gather to find the minimum metagenome cover : sourmash gather shew-merge.sig podar-ref.zip -o out.csv and then run sourmash tax metagenome to classify this as a \"mixture\" using the matching genomes from out.csv and their taxonomy in podar-lineage.csv : sourmash tax -g out.csv -t podar-lineage.csv and you should see: ,genus,1.000,Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella,491c0a81,,1.000,7886000 ,species,1.000,Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella;Shewanella baltica,491c0a81,,1.000,7886000 which shows that this is 100% Shewanella, as, well expected :). Categories This example belongs to the following categories: examples of using taxonomy examples using sourmash v4.2 functionality","title":"Example: use `sourmash tax` to classify a metagenome"},{"location":"3-use-sourmash-tax-to-classify-a-metagenome.html#example-use-sourmash-tax-to-classify-a-metagenome","text":"sourmash-bio/sourmash-examples#3 First, download and sketch 64 genomes from Awad et al., 2017 using the instructions in Example: download, sketch, and search a collection of FASTA files . You'll need podar-ref.zip . Next, you'll need podar-lineage.csv - curl -L [https://osf.io/4yhjw/download](https://osf.io/4yhjw/download) -o podar-lineage.csv Next we'll make a fake metagenome consisting of a signature created by merging two Shewanella baltica signatures. First, extract signatures with Shewanella in the name from podar-ref.zip : sourmash sig grep Shewanella podar-ref.zip -o shew-matches.sig Then, use sourmash sig merge to merge them into one signature: sourmash sig merge shew-matches.sig -o shew-merge.sig This is our fake metagenome that we'll use to demonstrate sourmash tax . Now that we've got our fake metagenome, run sourmash gather to find the minimum metagenome cover : sourmash gather shew-merge.sig podar-ref.zip -o out.csv and then run sourmash tax metagenome to classify this as a \"mixture\" using the matching genomes from out.csv and their taxonomy in podar-lineage.csv : sourmash tax -g out.csv -t podar-lineage.csv and you should see: ,genus,1.000,Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella,491c0a81,,1.000,7886000 ,species,1.000,Bacteria;Proteobacteria;Gammaproteobacteria;Alteromonadales;Shewanellaceae;Shewanella;Shewanella baltica,491c0a81,,1.000,7886000 which shows that this is 100% Shewanella, as, well expected :).","title":"Example: use sourmash tax to classify a metagenome"},{"location":"3-use-sourmash-tax-to-classify-a-metagenome.html#categories","text":"This example belongs to the following categories: examples of using taxonomy examples using sourmash v4.2 functionality","title":"Categories"},{"location":"4-use-picklists-and-manifests-to-work-with-a-small-subset-of-a-large-database.html","text":"Example: use picklists and manifests to work with a small subset of a large database sourmash-bio/sourmash-examples#4 Suppose you want to search, compare, or otherwise work with only a small set of genomes from GTDB - perhaps only the ones with \"Shewanella\" in their name. sourmash makes this easy! Start by downloading the GTDB genomic representatives database from the prepared databases . curl -JLO [https://osf.io/3a6gn/download](https://osf.io/3a6gn/download) This will download a 1.7 GB file named gtdb-rs207.genomic-reps.dna.k31.zip . Extract a manifest Now extract a manifest containing all of the metadata about signatures in this zip file: sourmash sig manifest gtdb-rs207.genomic-reps.dna.k31.zip -o gtdb.mf --no-rebuild (Here, the --no-rebuild just uses the manifest included in the zip file, rather than regenerating it from scratch.) Use csvtk to extract the name column and then use grep to select only those with Shewanella in their name - csvtk cut -f name gtdb.mf | grep -i Shewanella > shew.names.csv You should see that you have 98 matches: wc -l shew.names.csv Make a picklist from the manifest row names Turn this list into a picklist file by providing a column header: echo name > shew-picklist.csv cat shew.names.csv >> shew-picklist.csv `` ## Get a query signature Run: ```shell sourmash sig grep GCA_002341165 gtdb-rs207.genomic-reps.dna.k31.zip -o shew-query.sig to pick out just one of the Shewanella signatures, to use as a search query. Search using the picklist Now you can search just the Shewanella genomes using the picklist: sourmash search shew-query.sig gtdb-rs207.genomic-reps.dna.k31.zip --picklist shew-picklist.csv:name:name This is much faster than searching the entire database (which contains 66k signatures) as long as you know you just want to search that specific list of Shewanella genomes. Note: You could use just the space-delimited identifiers as a picklist, too, by using ident as the column type in the argument to --picklist , above. Please see the picklist docs for details. Categories This example belongs to the following categories: examples using GTDB RS207 examples using picklists intermediate examples","title":"Example: use picklists and manifests to work with a small subset of a large database"},{"location":"4-use-picklists-and-manifests-to-work-with-a-small-subset-of-a-large-database.html#example-use-picklists-and-manifests-to-work-with-a-small-subset-of-a-large-database","text":"sourmash-bio/sourmash-examples#4 Suppose you want to search, compare, or otherwise work with only a small set of genomes from GTDB - perhaps only the ones with \"Shewanella\" in their name. sourmash makes this easy! Start by downloading the GTDB genomic representatives database from the prepared databases . curl -JLO [https://osf.io/3a6gn/download](https://osf.io/3a6gn/download) This will download a 1.7 GB file named gtdb-rs207.genomic-reps.dna.k31.zip .","title":"Example: use picklists and manifests to work with a small subset of a large database"},{"location":"4-use-picklists-and-manifests-to-work-with-a-small-subset-of-a-large-database.html#extract-a-manifest","text":"Now extract a manifest containing all of the metadata about signatures in this zip file: sourmash sig manifest gtdb-rs207.genomic-reps.dna.k31.zip -o gtdb.mf --no-rebuild (Here, the --no-rebuild just uses the manifest included in the zip file, rather than regenerating it from scratch.) Use csvtk to extract the name column and then use grep to select only those with Shewanella in their name - csvtk cut -f name gtdb.mf | grep -i Shewanella > shew.names.csv You should see that you have 98 matches: wc -l shew.names.csv","title":"Extract a manifest"},{"location":"4-use-picklists-and-manifests-to-work-with-a-small-subset-of-a-large-database.html#make-a-picklist-from-the-manifest-row-names","text":"Turn this list into a picklist file by providing a column header: echo name > shew-picklist.csv cat shew.names.csv >> shew-picklist.csv `` ## Get a query signature Run: ```shell sourmash sig grep GCA_002341165 gtdb-rs207.genomic-reps.dna.k31.zip -o shew-query.sig to pick out just one of the Shewanella signatures, to use as a search query.","title":"Make a picklist from the manifest row names"},{"location":"4-use-picklists-and-manifests-to-work-with-a-small-subset-of-a-large-database.html#search-using-the-picklist","text":"Now you can search just the Shewanella genomes using the picklist: sourmash search shew-query.sig gtdb-rs207.genomic-reps.dna.k31.zip --picklist shew-picklist.csv:name:name This is much faster than searching the entire database (which contains 66k signatures) as long as you know you just want to search that specific list of Shewanella genomes. Note: You could use just the space-delimited identifiers as a picklist, too, by using ident as the column type in the argument to --picklist , above. Please see the picklist docs for details.","title":"Search using the picklist"},{"location":"4-use-picklists-and-manifests-to-work-with-a-small-subset-of-a-large-database.html#categories","text":"This example belongs to the following categories: examples using GTDB RS207 examples using picklists intermediate examples","title":"Categories"},{"location":"5-search-collection-manifests-directly.html","text":"Example: search collection manifests directly sourmash-bio/sourmash-examples#5 This example follows from Example: use picklists and manifests to work with a small subset of a large database . In #4, we see how to use a picklist to search a small subset of GTDB. But we can make this even simpler. Build a manifest that you can search directly Specifying the picklist is cumbersome if you want to search this database repeatedly. sourmash also lets you build a collection manifest that contains pointers into the database, using sig check ( doc link ). To create the collection manifest, first make a \"pathlist\" file, a text file containing the paths of sourmash databases you want to work with. In this case, the file will only contain one pathname, the GTDB database. ls gtdb-rs207.genomic-reps.dna.k31.zip > pathlist.txt Then, run: sourmash sig check --picklist shew-picklist.csv:name:name \\ pathlist.txt --save-manifest shew-mf.csv which will create a manifest in shew-mf.csv for all the entries that match the given picklist. You can now search this manifest file directly: sourmash search shew-query.sig shew-mf.csv Categories This example belongs to the following categories: examples of using manifests advanced examples examples that need improvement","title":"Example: search collection manifests directly"},{"location":"5-search-collection-manifests-directly.html#example-search-collection-manifests-directly","text":"sourmash-bio/sourmash-examples#5 This example follows from Example: use picklists and manifests to work with a small subset of a large database . In #4, we see how to use a picklist to search a small subset of GTDB. But we can make this even simpler.","title":"Example: search collection manifests directly"},{"location":"5-search-collection-manifests-directly.html#build-a-manifest-that-you-can-search-directly","text":"Specifying the picklist is cumbersome if you want to search this database repeatedly. sourmash also lets you build a collection manifest that contains pointers into the database, using sig check ( doc link ). To create the collection manifest, first make a \"pathlist\" file, a text file containing the paths of sourmash databases you want to work with. In this case, the file will only contain one pathname, the GTDB database. ls gtdb-rs207.genomic-reps.dna.k31.zip > pathlist.txt Then, run: sourmash sig check --picklist shew-picklist.csv:name:name \\ pathlist.txt --save-manifest shew-mf.csv which will create a manifest in shew-mf.csv for all the entries that match the given picklist. You can now search this manifest file directly: sourmash search shew-query.sig shew-mf.csv","title":"Build a manifest that you can search directly"},{"location":"5-search-collection-manifests-directly.html#categories","text":"This example belongs to the following categories: examples of using manifests advanced examples examples that need improvement","title":"Categories"},{"location":"6-create-a-conda-environment-with-the-latest-version-of-sourmash.html","text":"Example: create a conda environment with the latest version of sourmash sourmash-bio/sourmash-examples#6 Per @bluegenes tested by @jessicalumian. Create a file sourmash-latest.yml containing the dependencies, plus a pointer to the latest version of sourmash: channels: - conda-forge - bioconda - defaults dependencies: - python=3.9 - rust - pip - pip: - git+[https://github.com/sourmash-bio/sourmash@latest](https://github.com/sourmash-bio/sourmash@latest) and then run: conda env create -n sourmash-latest -f sourmash-latest.yml Wait for it to build (~5 min?) and then conda activate sourmash-latest and then run: sourmash info Categories This example belongs to the following categories: advanced examples examples for developers installation examples","title":"Example: create a conda environment with the latest version of sourmash"},{"location":"6-create-a-conda-environment-with-the-latest-version-of-sourmash.html#example-create-a-conda-environment-with-the-latest-version-of-sourmash","text":"sourmash-bio/sourmash-examples#6 Per @bluegenes tested by @jessicalumian. Create a file sourmash-latest.yml containing the dependencies, plus a pointer to the latest version of sourmash: channels: - conda-forge - bioconda - defaults dependencies: - python=3.9 - rust - pip - pip: - git+[https://github.com/sourmash-bio/sourmash@latest](https://github.com/sourmash-bio/sourmash@latest) and then run: conda env create -n sourmash-latest -f sourmash-latest.yml Wait for it to build (~5 min?) and then conda activate sourmash-latest and then run: sourmash info","title":"Example: create a conda environment with the latest version of sourmash"},{"location":"6-create-a-conda-environment-with-the-latest-version-of-sourmash.html#categories","text":"This example belongs to the following categories: advanced examples examples for developers installation examples","title":"Categories"},{"location":"7-use-genomeupdater.sh-and-sketch-fromfile-to-build-a-custom-database-from-ncbi.html","text":"Example: use genome_updater.sh and sketch fromfile to build a custom database from NCBI sourmash-bio/sourmash-examples#7 I wanted to build a database with custom k-size values containing all genomes under taxid Shewanella . First, I installed https://github.com/pirovc/genome_updater: mamba install -y genome_updater Then I ran: genome_updater.sh -T 22 -d \"genbank\" -f \"genomic.fna.gz\" -o shew -t 6 which produced shew/2022-05-06_13-58-43/ . Next, I ran: ../database-examples/genbank-to-fromfile.py shew/2022-05-06_13-58-43/files/GCA_* \\ -S shew/2022-05-06_13-58-43/assembly_summary.txt -o shewanella.csv (using a checkout of https://github.com/sourmash-bio/database-examples at this release .) This resulted in the following output: Loaded 439 rows from 'shew/2022-05-06_13-58-43/assembly_summary.txt' Any survivable errors will be reported to 'shewanella.csv.error-report.txt' processing file 'GCA_000712635.2_SXM1.0_for_version_1_of_the_Shewanella_xiamenenprocessing file 'GCA_000947195.1_Shewanella_algae_MARS_14_genomic.fna.gz' (42/43processing file 'GCA_900079515.1_Shewanella_sp.Alg231_23_genomic.fna.gz' (426/43processing file 'GCA_900156405.1_IMG-taxon_2681812898_annotated_assembly_genomicprocessing file 'GCA_913058445.1_SRR3933262_bin.2_MetaBAT_v2.12.1_MAG_genomic.fnprocessed 439 files. --- wrote 439 entries to 'shewanella.csv' 439 entries had only protein (and no genome) files. Using this, I could then run sourmash sketch fromfile shewanella.csv -p <my parameters here> ... Categories This example belongs to the following categories: creating databases","title":"Example: use `genome_updater.sh` and `sketch fromfile` to build a custom database from NCBI"},{"location":"7-use-genomeupdater.sh-and-sketch-fromfile-to-build-a-custom-database-from-ncbi.html#example-use-genome_updatersh-and-sketch-fromfile-to-build-a-custom-database-from-ncbi","text":"sourmash-bio/sourmash-examples#7 I wanted to build a database with custom k-size values containing all genomes under taxid Shewanella . First, I installed https://github.com/pirovc/genome_updater: mamba install -y genome_updater Then I ran: genome_updater.sh -T 22 -d \"genbank\" -f \"genomic.fna.gz\" -o shew -t 6 which produced shew/2022-05-06_13-58-43/ . Next, I ran: ../database-examples/genbank-to-fromfile.py shew/2022-05-06_13-58-43/files/GCA_* \\ -S shew/2022-05-06_13-58-43/assembly_summary.txt -o shewanella.csv (using a checkout of https://github.com/sourmash-bio/database-examples at this release .) This resulted in the following output: Loaded 439 rows from 'shew/2022-05-06_13-58-43/assembly_summary.txt' Any survivable errors will be reported to 'shewanella.csv.error-report.txt' processing file 'GCA_000712635.2_SXM1.0_for_version_1_of_the_Shewanella_xiamenenprocessing file 'GCA_000947195.1_Shewanella_algae_MARS_14_genomic.fna.gz' (42/43processing file 'GCA_900079515.1_Shewanella_sp.Alg231_23_genomic.fna.gz' (426/43processing file 'GCA_900156405.1_IMG-taxon_2681812898_annotated_assembly_genomicprocessing file 'GCA_913058445.1_SRR3933262_bin.2_MetaBAT_v2.12.1_MAG_genomic.fnprocessed 439 files. --- wrote 439 entries to 'shewanella.csv' 439 entries had only protein (and no genome) files. Using this, I could then run sourmash sketch fromfile shewanella.csv -p <my parameters here> ...","title":"Example: use genome_updater.sh and sketch fromfile to build a custom database from NCBI"},{"location":"7-use-genomeupdater.sh-and-sketch-fromfile-to-build-a-custom-database-from-ncbi.html#categories","text":"This example belongs to the following categories: creating databases","title":"Categories"},{"location":"9-install-sourmash.html","text":"Example: install sourmash sourmash-bio/sourmash-examples#9 Installing sourmash on Mac OS or Linux To install sourmash with pip, a common Python installer, run: pip install sourmash See the official Python docs for installing packages for details. To install sourmash into your existing conda environment from bioconda , run: conda install sourmash You'll need to have the bioconda and conda-forge channels configured in your conda install; see the bioconda documentation . Installing sourmash on Windows We do not yet officially support Windows, but sourmash can be installed on Windows. Visit the windows install issue to see the current status! More detailed installation instructions Please see the quickstart tutorial for more information on how to install sourmash using conda. Categories This example belongs to the following categories: introductory examples installation examples","title":"Example: install sourmash"},{"location":"9-install-sourmash.html#example-install-sourmash","text":"sourmash-bio/sourmash-examples#9","title":"Example: install sourmash"},{"location":"9-install-sourmash.html#installing-sourmash-on-mac-os-or-linux","text":"To install sourmash with pip, a common Python installer, run: pip install sourmash See the official Python docs for installing packages for details. To install sourmash into your existing conda environment from bioconda , run: conda install sourmash You'll need to have the bioconda and conda-forge channels configured in your conda install; see the bioconda documentation .","title":"Installing sourmash on Mac OS or Linux"},{"location":"9-install-sourmash.html#installing-sourmash-on-windows","text":"We do not yet officially support Windows, but sourmash can be installed on Windows. Visit the windows install issue to see the current status!","title":"Installing sourmash on Windows"},{"location":"9-install-sourmash.html#more-detailed-installation-instructions","text":"Please see the quickstart tutorial for more information on how to install sourmash using conda.","title":"More detailed installation instructions"},{"location":"9-install-sourmash.html#categories","text":"This example belongs to the following categories: introductory examples installation examples","title":"Categories"},{"location":"examples.html","text":"All examples Go to: Home | All categories Example: install sourmash Example: create a signature by downloading and sketching a genome sequence Example: download and search 66,000 GTDB genomes with a query genome Example: create a metagenome signature from shotgun sequencing reads Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: ask for an example of how to use sourmash to do something Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI) Example: create a conda environment with the latest version of sourmash Example: create and use an LCA database for taxonomic analysis Example: detect potential contaminants in unassembled and uncorrected PacBio sequencing data Example: download, sketch, and search a collection of FASTA files Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: search collection manifests directly Example: use genome_updater.sh and sketch fromfile to build a custom database from NCBI Example: use sourmash tax to classify a metagenome Example: use picklists and manifests to work with a small subset of a large database","title":"All examples"},{"location":"examples.html#all-examples","text":"Go to: Home | All categories Example: install sourmash Example: create a signature by downloading and sketching a genome sequence Example: download and search 66,000 GTDB genomes with a query genome Example: create a metagenome signature from shotgun sequencing reads Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: ask for an example of how to use sourmash to do something Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI) Example: create a conda environment with the latest version of sourmash Example: create and use an LCA database for taxonomic analysis Example: detect potential contaminants in unassembled and uncorrected PacBio sequencing data Example: download, sketch, and search a collection of FASTA files Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: search collection manifests directly Example: use genome_updater.sh and sketch fromfile to build a custom database from NCBI Example: use sourmash tax to classify a metagenome Example: use picklists and manifests to work with a small subset of a large database","title":"All examples"},{"location":"l-advanced.html","text":"Category: advanced examples Example: create a conda environment with the latest version of sourmash Example: search collection manifests directly","title":"Category: advanced examples"},{"location":"l-advanced.html#category-advanced-examples","text":"Example: create a conda environment with the latest version of sourmash Example: search collection manifests directly","title":"Category: advanced examples"},{"location":"l-ani.html","text":"Category: using Average Nucleotide Identity (ANI) Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI)","title":"Category: using Average Nucleotide Identity (ANI)"},{"location":"l-ani.html#category-using-average-nucleotide-identity-ani","text":"Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI)","title":"Category: using Average Nucleotide Identity (ANI)"},{"location":"l-databases.html","text":"Category: creating databases Example: use genome_updater.sh and sketch fromfile to build a custom database from NCBI","title":"Category: creating databases"},{"location":"l-databases.html#category-creating-databases","text":"Example: use genome_updater.sh and sketch fromfile to build a custom database from NCBI","title":"Category: creating databases"},{"location":"l-developer.html","text":"Category: examples for developers Example: create a conda environment with the latest version of sourmash","title":"Category: examples for developers"},{"location":"l-developer.html#category-examples-for-developers","text":"Example: create a conda environment with the latest version of sourmash","title":"Category: examples for developers"},{"location":"l-fasta.html","text":"Category: working with FASTA files Example: download and search 66,000 GTDB genomes with a query genome Example: create a signature by downloading and sketching a genome sequence Example: download, sketch, and search a collection of FASTA files","title":"Category: working with FASTA files"},{"location":"l-fasta.html#category-working-with-fasta-files","text":"Example: download and search 66,000 GTDB genomes with a query genome Example: create a signature by downloading and sketching a genome sequence Example: download, sketch, and search a collection of FASTA files","title":"Category: working with FASTA files"},{"location":"l-fastq.html","text":"Category: working with FASTQ files Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: create a metagenome signature from shotgun sequencing reads","title":"Category: working with FASTQ files"},{"location":"l-fastq.html#category-working-with-fastq-files","text":"Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: create a metagenome signature from shotgun sequencing reads","title":"Category: working with FASTQ files"},{"location":"l-genome.html","text":"Category: analyzing genomes Example: download and search 66,000 GTDB genomes with a query genome Example: create a signature by downloading and sketching a genome sequence","title":"Category: analyzing genomes"},{"location":"l-genome.html#category-analyzing-genomes","text":"Example: download and search 66,000 GTDB genomes with a query genome Example: create a signature by downloading and sketching a genome sequence","title":"Category: analyzing genomes"},{"location":"l-gtdb-rs207.html","text":"Category: examples using GTDB RS207 Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: download and search 66,000 GTDB genomes with a query genome Example: use picklists and manifests to work with a small subset of a large database","title":"Category: examples using GTDB RS207"},{"location":"l-gtdb-rs207.html#category-examples-using-gtdb-rs207","text":"Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: download and search 66,000 GTDB genomes with a query genome Example: use picklists and manifests to work with a small subset of a large database","title":"Category: examples using GTDB RS207"},{"location":"l-installation.html","text":"Category: installation examples Example: install sourmash Example: create a conda environment with the latest version of sourmash","title":"Category: installation examples"},{"location":"l-installation.html#category-installation-examples","text":"Example: install sourmash Example: create a conda environment with the latest version of sourmash","title":"Category: installation examples"},{"location":"l-intermediate.html","text":"Category: intermediate examples Example: detect potential contaminants in unassembled and uncorrected PacBio sequencing data Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: use picklists and manifests to work with a small subset of a large database","title":"Category: intermediate examples"},{"location":"l-intermediate.html#category-intermediate-examples","text":"Example: detect potential contaminants in unassembled and uncorrected PacBio sequencing data Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: use picklists and manifests to work with a small subset of a large database","title":"Category: intermediate examples"},{"location":"l-intro.html","text":"Category: introductory examples Example: ask for an example of how to use sourmash to do something Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: download and search 66,000 GTDB genomes with a query genome Example: create a metagenome signature from shotgun sequencing reads Example: create a signature by downloading and sketching a genome sequence Example: install sourmash","title":"Category: introductory examples"},{"location":"l-intro.html#category-introductory-examples","text":"Example: ask for an example of how to use sourmash to do something Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: download and search 66,000 GTDB genomes with a query genome Example: create a metagenome signature from shotgun sequencing reads Example: create a signature by downloading and sketching a genome sequence Example: install sourmash","title":"Category: introductory examples"},{"location":"l-manifests.html","text":"Category: examples of using manifests Example: search collection manifests directly","title":"Category: examples of using manifests"},{"location":"l-manifests.html#category-examples-of-using-manifests","text":"Example: search collection manifests directly","title":"Category: examples of using manifests"},{"location":"l-mapping.html","text":"Category: examples that refer to read mapping Example: estimate how much of a metagenome sample can be mapped to reference genomes","title":"Category: examples that refer to read mapping"},{"location":"l-mapping.html#category-examples-that-refer-to-read-mapping","text":"Example: estimate how much of a metagenome sample can be mapped to reference genomes","title":"Category: examples that refer to read mapping"},{"location":"l-metagenome.html","text":"Category: analyzing metagenomes Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: create a metagenome signature from shotgun sequencing reads","title":"Category: analyzing metagenomes"},{"location":"l-metagenome.html#category-analyzing-metagenomes","text":"Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: analyze a metagenome using 66,000 GTDB genomic representatives Example: create a metagenome signature from shotgun sequencing reads","title":"Category: analyzing metagenomes"},{"location":"l-needs-improvement.html","text":"Category: examples that need improvement Example: search collection manifests directly","title":"Category: examples that need improvement"},{"location":"l-needs-improvement.html#category-examples-that-need-improvement","text":"Example: search collection manifests directly","title":"Category: examples that need improvement"},{"location":"l-picklists.html","text":"Category: examples using picklists Example: use picklists and manifests to work with a small subset of a large database","title":"Category: examples using picklists"},{"location":"l-picklists.html#category-examples-using-picklists","text":"Example: use picklists and manifests to work with a small subset of a large database","title":"Category: examples using picklists"},{"location":"l-plotting.html","text":"Category: plots and other output visualizations Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI)","title":"Category: plots and other output visualizations"},{"location":"l-plotting.html#category-plots-and-other-output-visualizations","text":"Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI)","title":"Category: plots and other output visualizations"},{"location":"l-sourmash-v4.0.html","text":"Category: examples using sourmash v4.x Example: download, sketch, and search a collection of FASTA files","title":"Category: examples using sourmash v4.x"},{"location":"l-sourmash-v4.0.html#category-examples-using-sourmash-v4x","text":"Example: download, sketch, and search a collection of FASTA files","title":"Category: examples using sourmash v4.x"},{"location":"l-sourmash-v4.2.html","text":"Category: examples using sourmash v4.2 functionality Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: use sourmash tax to classify a metagenome","title":"Category: examples using sourmash v4.2 functionality"},{"location":"l-sourmash-v4.2.html#category-examples-using-sourmash-v42-functionality","text":"Example: estimate how much of a metagenome sample can be mapped to reference genomes Example: use sourmash tax to classify a metagenome","title":"Category: examples using sourmash v4.2 functionality"},{"location":"l-sourmash-v4.4.html","text":"Category: examples using sourmash v4.4 functionality Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI) Example: create and use an LCA database for taxonomic analysis","title":"Category: examples using sourmash v4.4 functionality"},{"location":"l-sourmash-v4.4.html#category-examples-using-sourmash-v44-functionality","text":"Example: compare and visualize the similarity of many genomes using Average Nucleotide Identity (ANI) Example: create and use an LCA database for taxonomic analysis","title":"Category: examples using sourmash v4.4 functionality"},{"location":"l-taxonomy.html","text":"Category: examples of using taxonomy Example: use sourmash tax to classify a metagenome Example: create and use an LCA database for taxonomic analysis","title":"Category: examples of using taxonomy"},{"location":"l-taxonomy.html#category-examples-of-using-taxonomy","text":"Example: use sourmash tax to classify a metagenome Example: create and use an LCA database for taxonomic analysis","title":"Category: examples of using taxonomy"},{"location":"labels.html","text":"All categories Go to: Home | All examples intermediate examples - 3 examples introductory examples - 6 examples examples using sourmash v4.4 functionality - 2 examples using Average Nucleotide Identity (ANI) - 1 examples plots and other output visualizations - 1 examples examples using sourmash v4.2 functionality - 2 examples examples using GTDB RS207 - 4 examples analyzing metagenomes - 3 examples examples that refer to read mapping - 1 examples working with FASTQ files - 2 examples working with FASTA files - 3 examples analyzing genomes - 2 examples installation examples - 2 examples creating databases - 1 examples advanced examples - 2 examples examples for developers - 1 examples examples of using manifests - 1 examples examples that need improvement - 1 examples examples using picklists - 1 examples examples of using taxonomy - 2 examples examples using sourmash v4.x - 1 examples","title":"All categories"},{"location":"labels.html#all-categories","text":"Go to: Home | All examples intermediate examples - 3 examples introductory examples - 6 examples examples using sourmash v4.4 functionality - 2 examples using Average Nucleotide Identity (ANI) - 1 examples plots and other output visualizations - 1 examples examples using sourmash v4.2 functionality - 2 examples examples using GTDB RS207 - 4 examples analyzing metagenomes - 3 examples examples that refer to read mapping - 1 examples working with FASTQ files - 2 examples working with FASTA files - 3 examples analyzing genomes - 2 examples installation examples - 2 examples creating databases - 1 examples advanced examples - 2 examples examples for developers - 1 examples examples of using manifests - 1 examples examples that need improvement - 1 examples examples using picklists - 1 examples examples of using taxonomy - 2 examples examples using sourmash v4.x - 1 examples","title":"All categories"}]}